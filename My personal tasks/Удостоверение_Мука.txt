Процедура ПечатьУдостоверениеМука(Анализ, Количество, Характеристика) Экспорт
    Макет = ПолучитьМакет("ПФ_MXL_УдостоверениеМука");
    ОбластьУдостоверение = Макет.ПолучитьОбласть("Удостоверение");
	
	//Общий табличный документ
    ТабДокумент = Новый ТабличныйДокумент;
    ТабДокумент.АвтоМасштаб = Истина;
	
	//Табличный документ для ОДНОГО экземпляра
	ВремТабДокумент = Новый ТабличныйДокумент;
	ВремТабДокумент.АвтоМасштаб = Истина;
	
	ПВХ = ПланыВидовХарактеристик.ВидыПоказателейКачестваЗерновых;
		
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	               |	ЗначенияПоказателейКачестваЗерновых.Показатель,
	               |	ЗначенияПоказателейКачестваЗерновых.Значение
	               |ИЗ
	               |	РегистрСведений.ЗначенияПоказателейКачестваЗерновых КАК ЗначенияПоказателейКачестваЗерновых
	               |ГДЕ
	               |	ЗначенияПоказателейКачестваЗерновых.Регистратор = &Анализ";
				   
	Запрос.УстановитьПараметр("Анализ", Анализ); 
	Результат = Запрос.Выполнить(); 
	ВыборкаДетальныеЗаписи = Результат.Выбрать(); 

	Структура = Новый Структура;
	СтруктураШапки = Новый Структура;
	
		
		
					//	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
					//		Если ВыборкаДетальныеЗаписи.Показатель.Предопределенный Тогда
					//			Структура.Вставить(ВыборкаДетальныеЗаписи.Показатель.Метаданные().Имя, ВыборкаДетальныеЗаписи.Значение);
					//		Иначе 
					//			Структура.Вставить(СтрЗаменить(ВыборкаДетальныеЗаписи.Показатель," ",""), ВыборкаДетальныеЗаписи.Значение); 
					//		КонецЕсли;
					//	КонецЦикла; 

					//	Если Структура.Количество() = 0 Тогда  
					//		Возврат; 
					//	КонецЕсли;
					//ОбластьУдостоверение.Параметры.Заполнить(Структура);
					
	СтруктураШапки.Вставить("Вид", Анализ.Номенклатура.Наименование); 
	СтруктураШапки.Вставить("ПунктПогрузки", ЭтотОбъект.ПунктПогрузки);
	СтруктураШапки.Вставить("Получатель", ЭтотОбъект.Контрагент);
	СтруктураШапки.Вставить("Отправитель", ЭтотОбъект.Организация);
	СтруктураШапки.Вставить("ПунктВыгрузки", ЭтотОбъект.ПунктРазгрузки);
	СтруктураШапки.Вставить("Автомобиль", ЭтотОбъект.Автомобиль);
	СтруктураШапки.Вставить("НомерНакладной", ЭтотОбъект.НомерБСО);
	СтруктураШапки.Вставить("Масса", Количество);
	СтруктураШапки.Вставить("Организация", ЭтотОбъект.Организация);
	СтруктураШапки.Вставить("ОКПО", ЭтотОбъект.НомерБСО);
		
	
	
	//Работа с датой
		Число = День(ЭтотОбъект.Дата);
		Год = Год(ЭтотОбъект.Дата);
		
		//месяц с учетом склонения русского языка
		Месяц = Сред(Формат(ЭтотОбъект.Дата, "ДФ='дд ММММ'"),3);
		
			СтруктураШапки.Вставить("ДатаДень", Число);
			СтруктураШапки.Вставить("ДатаМесяц", Месяц);
			СтруктураШапки.Вставить("ДатаГод", Год);
			
			Если Характеристика <> Неопределено Тогда
					 СтруктураШапки.Вставить("ЗнХарактеристики", "тара");
				Иначе
					 СтруктураШапки.Вставить("ЗнХарактеристики", "бестарка");
			КонецЕсли;
			
	ОбластьУдостоверение.Параметры.Заполнить(СтруктураШапки);
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл

		 Если ВыборкаДетальныеЗаписи.Показатель = ПВХ.Цвет Тогда
		    Структура.Вставить("Цвет", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.Вкус Тогда
		    Структура.Вставить("Вкус", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.КачествоКлейковины Тогда
		    Структура.Вставить("Качество", ВыборкаДетальныеЗаписи.Значение);
	 	 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.Зольность Тогда
	      	Структура.Вставить("Зольность", ВыборкаДетальныеЗаписи.Значение);
	  	 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ГОСТ_отбора Тогда	
		    Структура.Вставить("ГОСТ", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.СрокХранения Тогда	
		    Структура.Вставить("СрокХранения", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.Сорт Тогда
		    Структура.Вставить("Сорт", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.Запах Тогда
		    Структура.Вставить("Запах", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.МинеральнаяПримесь Тогда
		    Структура.Вставить("МинеральнаяПримесь", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.Влажность Тогда
		    Структура.Вставить("Влажность", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.МеталломагнитнаяПримесь Тогда	
		    Структура.Вставить("МагнитнаяПримесь", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ЧислоПадения Тогда
		    Структура.Вставить("Падение", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.КоличествоКлейковины Тогда
		    Структура.Вставить("Количество", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.Белизна Тогда
		    Структура.Вставить("Белизна", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПЭЦ_КалорийностьКДж Тогда
		    Структура.Вставить("ЭнергЦенностьКДж", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПЭЦ_КалорийностьККл Тогда
		    Структура.Вставить("ЭнергЦенностьКкал", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПЭЦ_Белок Тогда
		    Структура.Вставить("Белок", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПЭЦ_Жир Тогда
		    Структура.Вставить("Жир", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПЭЦ_Углеводы Тогда
		    Структура.Вставить("Углеводы", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ДатаВыбоя Тогда
		    Структура.Вставить("ДатаВыбоя", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ВлажностьПриВыбое Тогда
		    Структура.Вставить("ВлажностьПриВыбое", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.РДУ Тогда
		    Структура.Вставить("РДУ", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.СодержаниеРадионуклидов Тогда
		    Структура.Вставить("СодержаниеРадионуклидов", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ССНомерBY Тогда
		    Структура.Вставить("СертификатСоответствия", ВыборкаДетальныеЗаписи.Значение);
			
		 //Остаток на сите
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите0_67 Тогда
			Структура.Вставить("ОстатокНомер", "67");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите0_45 Тогда
			Структура.Вставить("ОстатокНомер", "45");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите23 Тогда
			Структура.Вставить("ОстатокНомер", "23");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите1мм Тогда
			Структура.Вставить("ОстатокНомер", "1");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите27 Тогда
			Структура.Вставить("ОстатокНомер", "27");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите35 Тогда
			Структура.Вставить("ОстатокНомер", "35");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите38 Тогда
			Структура.Вставить("ОстатокНомер", "38");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите43 Тогда
			Структура.Вставить("ОстатокНомер", "43");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		 ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ОстатокНаСите2мм Тогда
			Структура.Вставить("ОстатокНомер", "2");
			Структура.Вставить("Остаток", ВыборкаДетальныеЗаписи.Значение);
		
		//Проход через сито
		ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПроходЧерезСито23 Тогда
		    Структура.Вставить("ПроходНомер", "23");
			Структура.Вставить("Проход", ВыборкаДетальныеЗаписи.Значение);
		ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПроходЧерезСито38 Тогда
			Структура.Вставить("ПроходНомер", "38");
			Структура.Вставить("Проход", ВыборкаДетальныеЗаписи.Значение);
		ИначеЕсли ВыборкаДетальныеЗаписи.Показатель = ПВХ.ПроходЧерезСито43 Тогда
			Структура.Вставить("ПроходНомер", "43");
			Структура.Вставить("Проход", ВыборкаДетальныеЗаписи.Значение);
		КонецЕсли;
	КонецЦикла;
	
	
	
	Должность = Перечисления.ОтветственныеЛицаОрганизаций.ЗаведующийЛабораторией;
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	               |	ОтветственныеЛицаОрганизаций.ФизическоеЛицо,
	               |	ОтветственныеЛицаОрганизаций.ОтветственноеЛицо
	               |ИЗ
	               |	РегистрСведений.ОтветственныеЛицаОрганизаций КАК ОтветственныеЛицаОрганизаций";
				   
	Результат = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = Результат.Выбрать();	
	ВыборкаДетальныеЗаписи.Следующий();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Если ВыборкаДетальныеЗаписи.ОтветственноеЛицо = Должность Тогда
				ФамилияИнициалы = ОбщегоНазначения.ФамилияИнициалыФизЛица(ВыборкаДетальныеЗаписи.ФизическоеЛицо,,,,,);
				Структура.Вставить("НачальникПТЛ", ФамилияИнициалы); 
			КонецЕсли;
		КонецЦикла;
		
	ОбластьУдостоверение.Параметры.Заполнить(Структура);
	
	 //вывод на макет
	 //Выводим первый экземпляр
		ТабДокумент.Вывести(ОбластьУдостоверение);
		
		// Выводим во временный табличный документ второй экземпляр и вставляем в него слово "КОПИЯ"
		СтруктураШапки.Вставить("ПараметрКопия", "КОПИЯ");
		ОбластьУдостоверение.Параметры.Заполнить(СтруктураШапки);
		ВремТабДокумент.Вывести(ОбластьУдостоверение);

		
		// Выводим в общий табличный документ вторым экземпляром
		ТабДокумент.Вывести(ВремТабДокумент);
	    УниверсальныеМеханизмы.НапечататьДокумент(ТабДокумент, 1, Ложь, "Удостоверение на муку");
	
КонецПроцедуры